---
title: "Final Results"
output: html_notebook
date: "Spring 2022"
output:
  html_document:
    df_print: paged
  pdf_document:
    keep_tex: yes
---

# Intergenerational Childcare and Maternal Wages 

*Note that some results were adapted from work completed in Time Series Labs using the data that I downloaded, cleaned, and processed.* 

## Purpose 
This r markdown file (also rendered as R and md files) includes linear regression work exploring relative-provided childcare, relative avaialability within the US, and the differential impact relative-provided childcare would have on working mothers. 

## Hypotheses
* *Hypothesis 1*: Working mothers using relative-provided childcare as a primary childcare option will be more likely to experience lower wage disparities over time compared to working mothers using other forms of childcare.  
* *Hypothesis 2*: Working mothers with relatives in closer proximity will be more likely to experience lower wage disparities over time compared to working mothers without parents able to support them in childcare.
* *Hypothesis 3*: Comparatively, working mothers with higher levels of education will be less impacted (in terms of wage differential) by their parentsâ€™ capacity for support (of time and money). More clearly, it would be hypothesized that mothers with higher levels of education would be more likely to work in highly skilled work, have more financial ability to access paid childcare, and thus would be less influenced by parental support of time or money.

## Loading and Preprocessing Functions 

```{r load libraries, echo=FALSE, message=FALSE, warnings=FALSE}
library(plm)
library(dplyr)
library(plyr)
library(QMSS)
library(tidyverse)
library(stargazer)
library(psych)
library(ggplot2)
library(ggthemes) 
library(ggsci)
library(viridis)
library(hrbrthemes)
library(imputeTS)
library(kableExtra)
library(naniar)
library(plotly)
library(DT)
library(tidyr)
```

```{r functions}
# Select relevant columns and filter for individuals with valid data about their education, filter for women with some income generating work; filter for High School + 
# Make df that includes working women with valid data about childcare
Valid_Data <- function(df) { 
  NLSY_Valid <-  df %>% 
  filter(CV_HGC_EVER_EDT != 95 & !is.na(CV_HGC_EVER_EDT)) %>% 
  filter(CV_HGC_EVER_EDT >= 12) %>% filter(YEAR>=2005)
}

Valid_Childcare <- function(df,first_child) {
  NLSY_Valid <- Valid_Data(df)
  NLSY_Valid_Childcare <- NLSY_Valid %>% subset(INCOME>0) %>% subset(WORK_EDU_HRS>=0) %>% 
  subset(SELF_CARE==0) %>% subset(YEAR <= BIOCHILD_6_YR)
  if(first_child == TRUE) {
  NLSY_Valid_Childcare <- NLSY_Valid_Childcare %>% subset(YEAR <= BIOCHILD_6_YR)
  }
  else{
  NLSY_Valid_Childcare <- NLSY_Valid_Childcare %>% subset(CV_HH_UNDER_6>0)
  }
}


# Filter for data that includes working women (Part Time and up) with valid data about childcare
Valid_Childcare_Income <- function(df,first_child) {
  NLSY_Valid_Childcare <- Valid_Childcare(df,first_child)
  NLSY_Valid_Childcare_Income <- NLSY_Valid_Childcare %>% subset(INCOME>0) %>% subset(PART_TIME==1)
}
```

## Data
### Independent and Dependent Variables

#### Dependent Variables 
* INCOME - Income generated by respondent (Mother)

#### Independent Variables
* FAMILY_CARE - Childcare from Relative, Family Daycare (i.e., dropping child off with family), Sibling Care 
* Relative_within_15_minutes - Does a relative live within 15 minutes of the respondent? 

#### Control Variables 
* BA+ - Level of Education 
* N_CHILDREN - Number of children in household total (Not Applicable for models with only first child)
* MARRIED_OR_COHABITATING 
* MATERNAL_AGE 
* SPOUSAL_INCOME
* CV_INCOME_FAMILY

Datasets loaded are filtered for high school education and up, children under 6 years of age.
```{r load datasets}
# Childcare Variables here are averaged across children (YCCAL), looking at ANY child of respondent under 6 
load("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/data/NLSY_imputed.RData")
NLSY_Valid_Childcare_Part_Time_2 <- Valid_Childcare_Income(NLSY_imputed,FALSE) # Part Time and Above 
NLSY_Valid_Childcare_Income_2 <- Valid_Childcare(NLSY_imputed,FALSE) %>% subset(INCOME > 0) # Any Income Generated 

# Childcare Variables here are averaged across children (YCCAL), looking at respondents while their first child is under 6 years old
load("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/data/NLSY_imputed_first_child.RData")
NLSY_Valid_Childcare_Part_Time_1 <- Valid_Childcare_Income(NLSY_imputed,TRUE)
NLSY_Valid_Childcare_Income_1 <- Valid_Childcare(NLSY_imputed,TRUE) %>% subset(INCOME > 0)

# Only looking at parent having one child (first child) - while their first child is under 6 years old 
NLSY_Valid_Childcare_Part_Time_One_Child <- NLSY_Valid_Childcare_Part_Time_1 %>% subset(N_CHILDREN==1) 
NLSY_Valid_Childcare_Income_One_Child <- NLSY_Valid_Childcare_Income_1 %>% subset(INCOME > 0)

```

## Basic Model (`INCOME_LOG ~ FAMILY_CARE`, Net of `YEAR`)

### Dataset - Part Time Working Women with FIRST child and ONE child only

Once more, we want to start with some models looking women who work part time. Our dataset here includes all women with at least part-time (20+ hours) income-generating work, with their FIRST child only. I only include first child here to control for variables that may arise with additional children (e.g., motherhood experience, sibling-provided childcare, etc.). Note that for this mode of filtering, our sample size is relatively smaller, and a pooled model may be better given this consideration. 

#### Fixed Effects
```{r fe.basic_part_time, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}

fe.basic_part_time <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR),
               index = c("PUBID_1997", "YEAR"), # id & time variables
               model = "within", 
               data = NLSY_Valid_Childcare_Part_Time_One_Child) 
summary(fe.basic_part_time)
```

* *Fixed Effects Interpretation*: For working women (part time and above) with one child changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 4.7% increase in income net of person across the years that this study is conducted. This finding is not statistically significant; further, the adjusted R2 is negative, indicating that this model does not account for much. 

#### Random Effects 
```{r re.basic_part_time, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
re.basic_part_time  <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR), # model formula
               index = c("PUBID_1997", "YEAR"),
               model = "random", 
               data = NLSY_Valid_Childcare_Part_Time_One_Child)
summary(re.basic_part_time)
```
  
* *Random Effects Interpretation*: For working women (part time and above) with one child changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 0.1% decrease in income net of person across the years that this study is conducted, net of time and adjusting for the fact that the same person is answering the same survey. This finding is not statistically significant.

#### Pooled Model 
```{r pooled.basic_part_time, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
pooled.basic_part_time <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR),
               index = c("PUBID_1997", "YEAR"), 
               model = "pooling", 
               data = NLSY_Valid_Childcare_Part_Time_One_Child) ## this is equivalent to above OLS ##
summary(pooled.basic_part_time)
```
  
* *Pooled Model*: For every working woman (part time and above) with one child changing to family childcare (from non-family childcare), there is a 8.7% negative change in income on average net of time. This finding is statistically significant. 

#### Summary Table
```{r stargazer.basic_part_time, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
stargazer(fe.basic_part_time, re.basic_part_time, pooled.basic_part_time,
          title="Regression Results", 
          align=TRUE, 
          dep.var.labels=c("Income"), 
          no.space=TRUE, 
          column.labels=c("Fixed Effects", "Random Effects", "Pooled"), 
          dep.var.caption="", 
          model.numbers=FALSE,
          #type = "latex", 
          type = "text", 
          omit = "Constant")
```
  
* Overall, results **do not** support my initial Hypothesis 1, that women using family-based childcare options as their primary childcare source would comparatively have higher wages over time.  
* Of all these models, the only models showing any statistically significant results is the pooled model. 
* Results seem to indicate that **for panels of women with their first child under 6 who are working at least part time, the use of relative-provided childcare option (e.g. rather than other childcare options) corresponds with relatively statistically insignificant or negative impact on wage over time.**

### Dataset - ALL Working Women with FIRST child and ONE child only

I will now run the same models but without filtering for part-time work. My purpose here is to add back the variable `WORK_EDU_HRS` variable where it equals 0, because the questions corresponding (`YCCA-450` or `YCCAL-450`) are coded as '0' where women are staying at home with their child at all times. As this can include women who work at home at all times, I am continuing to filter for income > 0, and evaluating whether there happens to be increase in income when we are looking at **any** women generating any income (not necessarily part time, and potentially including those who work with their child) when they switch from other childcare options (incl. spouse, self-provided, and formal systems of childcare) to relative-provided childcare. 

#### Fixed Effects
```{r fe.basic_any_work, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
fe.basic_any_work <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR),
               index = c("PUBID_1997", "YEAR"), # id & time variables
               model = "within", 
               data = NLSY_Valid_Childcare_Income_One_Child) 
summary(fe.basic_any_work)
```

* *Fixed Effects Interpretation*: For working women with one child changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 1.5% decrease in income net of person across the years that this study is conducted. This finding is not statistically significant, and again, the adjusted R2 is negative, indicating that this model does not account for much. 

#### Random Effects 
```{r re.basic_any_work, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
re.basic_any_work  <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR), # model formula
               index = c("PUBID_1997", "YEAR"),
               model = "random", 
               data = NLSY_Valid_Childcare_Income_One_Child)
summary(re.basic_any_work)
```
  
* *Random Effects Interpretation*: For working women with one child changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 5% in income, net of person across the years that this study is conducted, net of time and adjusting for the fact that the same person is answering the same survey. This finding **is** statistically significant.

#### Pooled Model 
```{r pooled.basic_any_work, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
pooled.basic_any_work <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR),
               index = c("PUBID_1997", "YEAR"), 
               model = "pooling", 
               data = NLSY_Valid_Childcare_Income_One_Child) ## this is equivalent to above OLS ##
summary(pooled.basic_any_work)
```
  
* *Pooled Model Interpretation*: For working women with one child changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 14.5% increase in income, net of person across the years that this study is conducted, net of time and adjusting for the fact that the same person is answering the same survey. This finding **is** statistically significant.

#### Summary Table
```{r stargazer.basic_any_work, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
stargazer(fe.basic_any_work, re.basic_any_work, pooled.basic_any_work,
          title="Regression Results", 
          align=TRUE, 
          dep.var.labels=c("Income"), 
          no.space=TRUE, 
          column.labels=c("Fixed Effects", "Random Effects", "Pooled"), 
          dep.var.caption="", 
          model.numbers=FALSE,
          #type = "latex", 
          type = "text", 
          omit = "Constant")
```

* Results seem to indicate that **for panels of women with their first child under 6 who are working any hours, the use of relative-provided childcare option (e.g. rather than other childcare options including self-provided childcare) corresponds with positive impact on wage over time.**

### Dataset - Part Time Women with ANY children under 6

This time, our dataset here includes women with at least part-time (20+ hours) income-generating work, with their ANY child under 6 years of age.

#### Fixed Effects
```{r fe.basic_part_time_all, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}

fe.basic_part_time_all <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR),
               index = c("PUBID_1997", "YEAR"), # id & time variables
               model = "within", 
               data = NLSY_Valid_Childcare_Part_Time_2) 
summary(fe.basic_part_time_all)
```

* *Fixed Effects Interpretation*: For working women (part time and above) with one child changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 2% decrease in income net of person across the years that this study is conducted. This finding is not statistically significant and the R2 is negative. 

#### Random Effects 
```{r re.basic_part_time_all, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
re.basic_part_time_all  <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR), # model formula
               index = c("PUBID_1997", "YEAR"),
               model = "random", 
               data = NLSY_Valid_Childcare_Part_Time_2)
summary(re.basic_part_time_all)
```
  
* *Random Effects Interpretation*: For working women (part time and above) with any children changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 3.8% decrease in income net of person across the years that this study is conducted, net of time and adjusting for the fact that the same person is answering the same survey. This finding is not statistically significant.

#### Pooled Model 
```{r pooled.basic_part_time_all, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
pooled.basic_part_time_all <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR),
               index = c("PUBID_1997", "YEAR"), 
               model = "pooling", 
               data = NLSY_Valid_Childcare_Part_Time_2) ## this is equivalent to above OLS ##
summary(pooled.basic_part_time_all)
```
  
* *Pooled Model*: For every working woman (part time and above) with any children changing to family childcare (from non-family childcare), there is a 8.4% negative change in income on average net of time. This finding is statistically significant. 

#### Summary Table
```{r stargazer.basic_part_time_all, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
stargazer(fe.basic_part_time_all, re.basic_part_time_all, pooled.basic_part_time_all,
          title="Regression Results", 
          align=TRUE, 
          dep.var.labels=c("Income"), 
          no.space=TRUE, 
          column.labels=c("Fixed Effects", "Random Effects", "Pooled"), 
          dep.var.caption="", 
          model.numbers=FALSE,
          #type = "latex", 
          type = "text", 
          omit = "Constant")
```
  
* Similar to the part time with one child models, the results here  seem to indicate that **for panels of women working at least part-time with children under 6, the use of relative-provided childcare option (e.g. rather than other childcare options) corresponds with relatively statistically insignificant or negative impact on wage over time.**

Our next step is to add some controls. As alluded to in the Independent and Dependent Variables sections of this report, we will be controlling for socioeconomic status, education (BA vs not), marital status, and age of mother with first child. For these sections, I will be focusing on Part-Time working mothers only. 

## Model with Controls (Socioeconomic Indicator - Family Income)
### Dataset - Part Time Working Women with FIRST child and ONE child only

Once more, we want to start with some models looking women who work part time. Our dataset here includes all women with at least part-time (20+ hours) income-generating work, with their FIRST child only. I only include first child here to control for variables that may arise with additional children (e.g., motherhood experience, sibling-provided childcare, etc.). Note that for this mode of filtering, our sample size is relatively smaller, and a pooled model may be better given this consideration. 
* BA+ - Level of Education 
* N_CHILDREN - Number of children in household total (Not Applicable for models with only first child)
* MARRIED_OR_COHABITATING 
* MATERNAL_AGE 
* SPOUSAL_INCOME
#### Fixed Effects
```{r fe.part_time_1, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}

fe.basic_part_time <- plm(INCOME_LOG ~ FAMILY_CARE + MARRIED_OR_COHABITATING + BA_ABOVE + MATERNAL_AGE + CV_INCOME+ as.factor(YEAR),
               index = c("PUBID_1997", "YEAR"), # id & time variables
               model = "within", 
               data = NLSY_Valid_Childcare_Part_Time_One_Child) 
summary(fe.basic_part_time)
```

* *Fixed Effects Interpretation*: For working women (part time and above) with one child changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 4.7% increase in income net of person across the years that this study is conducted. This finding is not statistically significant; further, the adjusted R2 is negative, indicating that this model does not account for much. 

#### Random Effects 
```{r re.part_time_1, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
re.basic_part_time  <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR), # model formula
               index = c("PUBID_1997", "YEAR"),
               model = "random", 
               data = NLSY_Valid_Childcare_Part_Time_One_Child)
summary(re.basic_part_time)
```
  
* *Random Effects Interpretation*: For working women (part time and above) with one child changing to family childcare as the primary type of childcare (e.g., from formal childcare systems), there is a 0.1% decrease in income net of person across the years that this study is conducted, net of time and adjusting for the fact that the same person is answering the same survey. This finding is not statistically significant.

#### Pooled Model 
```{r pooled.part_time_1, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
pooled.basic_part_time <- plm(INCOME_LOG ~ FAMILY_CARE + as.factor(YEAR),
               index = c("PUBID_1997", "YEAR"), 
               model = "pooling", 
               data = NLSY_Valid_Childcare_Part_Time_One_Child) ## this is equivalent to above OLS ##
summary(pooled.basic_part_time)
```
  
* *Pooled Model*: For every working woman (part time and above) with one child changing to family childcare (from non-family childcare), there is a 8.7% negative change in income on average net of time. This finding is statistically significant. 

#### Summary Table
```{r stargazer.part_time_1, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE,column.sep.width = "1pt",comment=NA,font.size=8}
stargazer(fe.part_time_1, re.part_time_1, pooled.part_time_1,
          title="Regression Results", 
          align=TRUE, 
          dep.var.labels=c("Income"), 
          no.space=TRUE, 
          column.labels=c("Fixed Effects", "Random Effects", "Pooled"), 
          dep.var.caption="", 
          model.numbers=FALSE,
          #type = "latex", 
          type = "text", 
          omit = "Constant")
```
  
* Overall, results **do not** support my initial Hypothesis 1, that women using family-based childcare options as their primary childcare source would comparatively have higher wages over time.  
* Of all these models, the only models showing any statistically significant results is the pooled model. 
* Results seem to indicate that **for panels of women with their first child under 6 who are working at least part time, the use of relative-provided childcare option (e.g. rather than other childcare options) corresponds with relatively statistically insignificant or negative impact on wage over time.**


## Model with Controls (Socioeconomic Indicator - Spousal Income )

## Logistic Model - Part Time to Full Time


