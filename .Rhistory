#MARRIED_OR_COHABITATING == 1, ifelse(
CV_INCOME_FAMILY < 45000,'Lower-Class',
ifelse(CV_INCOME_FAMILY < 135000, 'Middle-Class','Upper-Class'))
#,ifelse(INCOME < 15000,'Lower-Class',
# ifelse(CV_INCOME_FAMILY < 75000, 'Middle-Class','Upper-Class'))))
) %>%
group_by(YEAR,SES) %>% mutate(Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
dplyr::group_by(YEAR) %>% mutate(Overall_Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
group_by(YEAR,Mean_Maternal_Age,Overall_Mean_Maternal_Age,SES) %>% dplyr::summarize()
mean_maternal_ages_ses %>%
ggplot(aes(x = YEAR)) +
geom_point(stat="identity",aes(y=Mean_Maternal_Age,color = SES)) +
geom_line(stat="identity",aes(y=Mean_Maternal_Age,color = SES)) +
geom_point(stat="identity",aes(y=Overall_Mean_Maternal_Age), alpha = 0.5) +
geom_line(stat="identity",aes(y=Overall_Mean_Maternal_Age), linetype = 'dashed', alpha = 0.5) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_continuous(limits=c(2010,2015)) +
labs(linetype = "Socioeconomic Status", color = "Socioeconomic Status",
y="Mean Age", x = "", title = "")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
knit_with_parameters("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
# No filtering for only individuals with valid data around inter-generational childcare
NLSY_Valid <-  NLSY_imputed %>%
filter(CV_HGC_EVER_EDT != 95 & !is.na(CV_HGC_EVER_EDT)) %>%
filter(CV_HGC_EVER_EDT >= 12)
NSLY_Valid_Summarized <- NLSY_Valid %>% dplyr::mutate(ANY_CHILDREN = ifelse(N_CHILDREN == 0,0,1)) %>% group_by(YEAR,ANY_CHILDREN) %>% dplyr::summarize(mean_income = mean(INCOME,na.rm=TRUE)) %>% mutate(ANY_CHILDREN = ifelse(ANY_CHILDREN==0,'No Children', 'One or More Children'))
NSLY_Valid_Summarized$YEAR <- as.numeric(NSLY_Valid_Summarized$YEAR)
NSLY_Valid_Summarized %>% subset(YEAR>=2005) %>%
ggplot(.,aes(x=YEAR, y=mean_income/1000)) +
geom_point(color = "#273237") +
geom_line(color = "#273237",aes(linetype = ANY_CHILDREN)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)
) +
scale_x_continuous(limits=c(2005,2010,2015)) +
labs(title = "",
y="Mean Annual Income\n($ thousands)", x = "",linetype = "")
NLSY_imputed_FAMILY_CARE_CAT <- NLSY_imputed_FAMILY_CARE_CAT %>% subset(!is.na(`YCCAL-6800`))
NLSY_imputed_FAMILY_CARE_CAT <- NLSY_imputed_FAMILY_CARE_CAT %>% subset(!is.na(FAMILY_CARE))
NLSY_imputed_FAMILY_CARE_CAT %>% dplyr::select(PUBID_1997,YEAR,`YCCAL-6800`,CV_HH_UNDER_6,CV_BIO_CHILD_HH,INCOME,CV_ENROLLSTAT_EDT,`YCCA-450`,`YCCAL-450`,FAMILY_CARE) %>% subset(CV_HH_UNDER_6>0 & CV_BIO_CHILD_HH>0) %>%
#subset(`YCCAL-450`!=0) %>%
dplyr::mutate(relative_15 = ifelse(`YCCAL-6800`==1, 'Yes',ifelse(`YCCAL-6800`==0,'No','NaN'))) %>%
dplyr::mutate(FAMILY_CARE_CAT = ifelse(`FAMILY_CARE`==0, 'No',ifelse(`FAMILY_CARE`==1,'Yes','NaN'))) %>%
dplyr::group_by(relative_15,FAMILY_CARE) %>%
dplyr::mutate(FAMILY_CARE_count = n()) %>% ungroup() %>%
mutate(perc=100*FAMILY_CARE_count/nrow(NLSY_imputed_FAMILY_CARE_CAT)) %>%
dplyr::group_by(relative_15, FAMILY_CARE_CAT,FAMILY_CARE_count,perc) %>%
dplyr::summarize() %>%
ggplot(aes(x = relative_15, y = perc)) +
geom_bar(stat="identity",aes(fill = FAMILY_CARE_CAT),position = "dodge") +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_fill_manual(values=c("#ff6f00", "#008fa0")) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = , color = 'Response') +
labs(fill = "Relative Care is a primary source of childcare?", y="Percent of Data", x = "Relative is within 15 Miles?")
NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,CV_BIO_CHILD_HH,CHILDCARE_TYPE) %>% subset(YEAR>2005) %>%
subset(CV_BIO_CHILD_HH==1) %>%
dplyr::group_by(YEAR) %>% mutate(Total_Year = n()) %>% ungroup() %>%
group_by(YEAR,CHILDCARE_TYPE) %>% dplyr::mutate(CHILDCARE_TYPE_COUNT = n()/Total_Year) %>% ungroup() %>%  dplyr::group_by(YEAR,CHILDCARE_TYPE, CHILDCARE_TYPE_COUNT) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = CHILDCARE_TYPE_COUNT)) +
geom_point(stat="identity",aes(color = CHILDCARE_TYPE)) +
geom_line(stat="identity",aes(color = CHILDCARE_TYPE, linetype = CHILDCARE_TYPE)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
#scale_fill_manual(values=c("#C9473B", "#75A1AD")) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_continuous(limits=c(2010,2015)) +
labs(linetype = "Type of Childcare", color = "Type of Childcare",
y="Count", x = "", title = "Intergenerational Childcare\n (all women with ONLY one biological child**)",
caption = "During first 6 years of first child")
NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,CV_BIO_CHILD_HH,CHILDCARE_TYPE) %>% subset(YEAR>2005) %>%
dplyr::group_by(YEAR) %>% mutate(Total_Year = n()) %>% ungroup() %>%
group_by(YEAR,CHILDCARE_TYPE) %>% dplyr::mutate(CHILDCARE_TYPE_COUNT = n()/Total_Year) %>% ungroup() %>%  dplyr::group_by(YEAR,CHILDCARE_TYPE, CHILDCARE_TYPE_COUNT) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = CHILDCARE_TYPE_COUNT)) +
geom_point(stat="identity",aes(color = CHILDCARE_TYPE)) +
geom_line(stat="identity",aes(color = CHILDCARE_TYPE, linetype = CHILDCARE_TYPE)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
#scale_fill_manual(values=c("#C9473B", "#75A1AD")) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_continuous(limits=c(2010,2015)) +
labs(linetype = "Type of Childcare", color = "Type of Childcare",
y="Proportion of Year*", x = "", title = "Intergenerational Childcare\n (all women with AT LEAST one biological child**)",
caption = "*Each year's aggregated group includes mothers whose first-born child is under 6 years of age.")
mean_maternal_ages <-  NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,WORK_EDU_HRS,FAMILY_CARE,MATERNAL_AGE) %>% subset(YEAR>2005) %>%
dplyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>%
dplyr::group_by(YEAR,FAMILY_CARE_CAT) %>% mutate(Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
dplyr::group_by(YEAR) %>% mutate(Overall_Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
group_by(YEAR,Mean_Maternal_Age,Overall_Mean_Maternal_Age,FAMILY_CARE_CAT) %>% dplyr::summarize()
mean_maternal_ages
mean_maternal_ages %>%
ggplot(aes(x = YEAR)) +
geom_point(stat="identity",aes(y=Mean_Maternal_Age,color = FAMILY_CARE_CAT)) +
geom_line(stat="identity",aes(y=Mean_Maternal_Age,color = FAMILY_CARE_CAT)) +
geom_point(stat="identity",aes(y=Overall_Mean_Maternal_Age), alpha = 0.5) +
geom_line(stat="identity",aes(y=Overall_Mean_Maternal_Age), linetype = 'dashed', alpha = 0.5) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_discrete(limits=c(2010,2015)) +
labs(linetype = "Relative-Provided Childcare", color = "Relative-Provided Childcare",
y="Mean Age", x = "", title = "")
ses_care_type <-  NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,MARRIED_OR_COHABITATING,INCOME,WORK_EDU_HRS,CV_INCOME_FAMILY,FAMILY_CARE,MATERNAL_AGE) %>% subset(YEAR>2005) %>%
dplyr::mutate(SES = ifelse(
#MARRIED_OR_COHABITATING == 1, ifelse(
CV_INCOME_FAMILY < 45000,'Lower-Class',
ifelse(CV_INCOME_FAMILY < 135000, 'Middle-Class','Upper-Class'))
#,ifelse(INCOME < 15000,'Lower-Class',
# ifelse(CV_INCOME_FAMILY < 75000, 'Middle-Class','Upper-Class'))))
) %>%
dplyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>%
dplyr::group_by(SES) %>% mutate(SES_TOT = n()) %>% ungroup() %>%
dplyr::group_by(SES,FAMILY_CARE_CAT) %>% mutate(CARE_TOT = n()) %>% ungroup() %>%
mutate(CARE_PROP = CARE_TOT/SES_TOT) %>% ungroup() %>%
group_by(SES,FAMILY_CARE_CAT,CARE_PROP) %>% dplyr::summarize()
ses_care_type %>%
ggplot(aes(x = SES, y= CARE_PROP)) +
geom_bar(stat="identity",aes(color = FAMILY_CARE_CAT,fill = FAMILY_CARE_CAT)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_color_futurama(alpha = 0.75) +
scale_fill_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
labs(linetype = "Socioeconomic Status", color = "Child Care Category", fill = "Child Care Category",
y="Proportion", x = "Socioeconomic Status (household income)", title = "Do richer people have more paid childcare? ")
mean_maternal_ages_ses <-  NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,MARRIED_OR_COHABITATING,INCOME,CV_INCOME_FAMILY,FAMILY_CARE,MATERNAL_AGE) %>% subset(YEAR>2005) %>%
dplyr::mutate(SES = ifelse(
#MARRIED_OR_COHABITATING == 1, ifelse(
CV_INCOME_FAMILY < 45000,'Lower-Class',
ifelse(CV_INCOME_FAMILY < 135000, 'Middle-Class','Upper-Class'))
#,ifelse(INCOME < 15000,'Lower-Class',
# ifelse(CV_INCOME_FAMILY < 75000, 'Middle-Class','Upper-Class'))))
) %>%
group_by(YEAR,SES) %>% mutate(Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
dplyr::group_by(YEAR) %>% mutate(Overall_Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
group_by(YEAR,Mean_Maternal_Age,Overall_Mean_Maternal_Age,SES) %>% dplyr::summarize()
mean_maternal_ages_ses %>%
ggplot(aes(x = YEAR)) +
geom_point(stat="identity",aes(y=Mean_Maternal_Age,color = SES)) +
geom_line(stat="identity",aes(y=Mean_Maternal_Age,color = SES)) +
geom_point(stat="identity",aes(y=Overall_Mean_Maternal_Age), alpha = 0.5) +
geom_line(stat="identity",aes(y=Overall_Mean_Maternal_Age), linetype = 'dashed', alpha = 0.5) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_continuous(limits=c(2010,2015)) +
labs(linetype = "Socioeconomic Status", color = "Socioeconomic Status",
y="Mean Age", x = "", title = "")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/draft_models.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/final_results.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/final_results.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/final_results.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
unlink("code/data_exploration/exploratory_analysis_cache", recursive = TRUE)
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
# Load Data - Pre-cleaned
NLSY_79 <- read.csv("~/QMSS/Intergenerational_Maternal_Wage_Gap/data/NLSY79/NLSY79_continuous.csv")
library(plm)
library(dplyr)
library(plyr)
library(QMSS)
library(tidyverse)
library(stargazer)
library(psych)
library(ggplot2)
library(ggthemes)
library(ggsci)
library(viridis)
library(hrbrthemes)
library(imputeTS)
library(kableExtra)
library(naniar)
library(plotly)
library(DT)
library(tidyr)
# Load Data - Pre-cleaned
load("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/data/NLSY_new_shortened.RData")
# Select relevant columns and filter for individuals with valid data about their education, filter for women with some income generating work; filter for High School +
# Make df that includes working women with valid data about childcare
Valid_Childcare <- function(df,first_child) {
NLSY_Valid <-  df %>%
filter(CV_HGC_EVER_EDT != 95 & !is.na(CV_HGC_EVER_EDT)) %>%
filter(CV_HGC_EVER_EDT >= 12)
NLSY_Valid_Childcare <- NLSY_Valid %>% subset(INCOME>0) %>% subset(WORK_EDU_HRS>=0) %>%
subset(SELF_CARE==0) %>% subset(YEAR <= BIOCHILD_6_YR)
if(first_child == TRUE) {
NLSY_Valid_Childcare <- NLSY_Valid_Childcare %>% subset(YEAR <= BIOCHILD_6_YR)
}
else{
NLSY_Valid_Childcare <- NLSY_Valid_Childcare %>% subset(CV_HH_UNDER_6>0)
}
}
# Filter for data that includes working women (Part Time and up) with valid data about childcare
Valid_Childcare_Income <- function(df) {
NLSY_Valid_Childcare_Income <- df %>% subset(INCOME>0) %>% subset(PART_TIME==1)
}
load("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/data/NLSY_imputed_first_child.RData")
NLSY_Valid <-  NLSY_imputed %>%
filter(CV_HGC_EVER_EDT != 95 & !is.na(CV_HGC_EVER_EDT)) %>%
filter(CV_HGC_EVER_EDT >= 12)
dt <- describe(NLSY_Valid %>% select(INCOME,FAMILY_CARE,`YCCAL-6800`,BA_ABOVE,N_CHILDREN,MARRIED_OR_COHABITATING,SPOUSAL_INCOME,MATERNAL_AGE))
dt
load("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/data/NLSY_imputed_first_child.RData")
NLSY_Valid_Childcare_1 <- Valid_Childcare(NLSY_imputed,TRUE)
NLSY_imputed <- NLSY_imputed[!is.na(NLSY_imputed$WORK_EDU_HRS),]
# This is just with everyone with any biological children in the household; it appears here that we don't have a lot of present data.
p1 <- NLSY_imputed %>% dplyr::select(PUBID_1997,YEAR,BIOCHILD_6_YR,INCOME,`YCCAL-1100A~000002`,`YCCA-1100A~000002`,`FAMILY_CARE`,`RELATIVE_CARE`,WORK_EDU_HRS,CV_BIO_CHILD_HH) %>% subset(YEAR>=2005) %>% subset(INCOME>0)  %>% subset(CV_BIO_CHILD_HH>0) %>% plyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>% dplyr::group_by(YEAR,FAMILY_CARE_CAT) %>% dplyr::mutate(FAMILY_CARE_CAT_proportion = n()) %>% ungroup() %>% dplyr::group_by(YEAR,FAMILY_CARE_CAT, FAMILY_CARE_CAT_proportion) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = FAMILY_CARE_CAT_proportion)) +
geom_bar(stat="identity",aes(fill = FAMILY_CARE_CAT)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_fill_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
labs(fill = "Primary Child Care Method is Relative-provided Care",
y="Count", x = "", title = "Relative-provided Childcare (Any child under 6)")
p1
ggplotly(p1)
p2 <- NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,BIOCHILD_6_YR,INCOME,PART_TIME,`FAMILY_CARE`,`RELATIVE_CARE`,WORK_EDU_HRS,CV_BIO_CHILD_HH) %>% subset(YEAR>=2005) %>% subset(INCOME>0) %>% subset(YEAR <= BIOCHILD_6_YR) %>% subset(CV_BIO_CHILD_HH>0) %>%
subset(PART_TIME ==1) %>% dplyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>% dplyr::group_by(YEAR,FAMILY_CARE_CAT) %>% dplyr::mutate(FAMILY_CARE_CAT_proportion = n()) %>% ungroup() %>% dplyr::group_by(YEAR,FAMILY_CARE_CAT, FAMILY_CARE_CAT_proportion) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = FAMILY_CARE_CAT_proportion)) +
geom_bar(stat="identity",aes(fill = FAMILY_CARE_CAT)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_fill_manual(values=c("#ff6f00", "#008fa0")) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
labs(fill = "Primary Child Care Method is Relative-provided Care",
y="Count", x = "", title = "Relative-Provided Childcare (First Child,\n 6 and under, Part Time Work )")
p2
#ggplotly(p2)
p3 <- NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,BIOCHILD_6_YR,INCOME,PART_TIME,`FAMILY_CARE`,`RELATIVE_CARE`,WORK_EDU_HRS,CV_BIO_CHILD_HH) %>% subset(YEAR>=2005) %>% subset(INCOME>0) %>% subset(YEAR <= BIOCHILD_6_YR) %>% subset(CV_BIO_CHILD_HH==1) %>%
subset(PART_TIME ==1) %>% dplyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>% dplyr::group_by(YEAR,FAMILY_CARE_CAT) %>% dplyr::mutate(FAMILY_CARE_CAT_proportion = n()) %>% ungroup() %>% dplyr::group_by(YEAR,FAMILY_CARE_CAT, FAMILY_CARE_CAT_proportion) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = FAMILY_CARE_CAT_proportion)) +
geom_bar(stat="identity",aes(fill = FAMILY_CARE_CAT)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_fill_manual(values=c("#ff6f00", "#008fa0")) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
labs(fill = "Primary Child Care Method is Relative-provided Care",
y="Count", x = "", title = "Intergenerational Childcare (First Child,\n 6 and under,\n Part Time Work )")
p3
#ggplotly(p3)
load("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/data/NLSY_imputed.RData")
NLSY_Valid_Childcare_2 <- Valid_Childcare(NLSY_imputed,FALSE)
p4 <- NLSY_Valid_Childcare_2 %>% dplyr::select(PUBID_1997,YEAR,INCOME,PART_TIME,`FAMILY_CARE`,`RELATIVE_CARE`,WORK_EDU_HRS,CV_BIO_CHILD_HH) %>% subset(YEAR>=2005) %>% subset(INCOME>0) %>% subset(CV_BIO_CHILD_HH>0) %>%
subset(PART_TIME ==1) %>% dplyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>% dplyr::group_by(YEAR,FAMILY_CARE_CAT) %>% dplyr::mutate(FAMILY_CARE_CAT_proportion = n()) %>% ungroup() %>% dplyr::group_by(YEAR,FAMILY_CARE_CAT, FAMILY_CARE_CAT_proportion) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = FAMILY_CARE_CAT_proportion)) +
geom_bar(stat="identity",aes(fill = FAMILY_CARE_CAT)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_fill_manual(values=c("#ff6f00", "#008fa0")) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
labs(fill = "Primary Child Care Method is Relative-provided Care",
y="Count", x = "", title = "Intergenerational Childcare (First Child Only,\n 6 and under,\n Part Time Work )")
p4
#ggplotly(p4)
NLSY_imputed$`YCCA-450`<- as.numeric(NLSY_imputed$`YCCA-450`)
NLSY_imputed$`YCCAL-450`<- as.numeric(NLSY_imputed$`YCCAL-450`)
NLSY_imputed_FAMILY_CARE_CAT <- NLSY_imputed %>% subset(!is.na(`YCCAL-1100A~000002`))
NLSY_imputed_FAMILY_CARE_CAT$YEAR <- as.numeric(NLSY_imputed_FAMILY_CARE_CAT$YEAR)
NLSY_imputed_FAMILY_CARE_CAT$`YCCAL-6800`[is.na(NLSY_imputed_FAMILY_CARE_CAT$`YCCAL-6800`)] <- 'NA'
p5 <- NLSY_imputed_FAMILY_CARE_CAT %>% dplyr::select(PUBID_1997,YEAR,`YCCAL-6800`,CV_HH_UNDER_6,CV_BIO_CHILD_HH,INCOME,CV_ENROLLSTAT_EDT,`YCCA-450`,`YCCAL-450`,FAMILY_CARE) %>% subset(CV_HH_UNDER_6>0 & CV_BIO_CHILD_HH>0) %>%
subset(INCOME>0) %>%
dplyr::mutate(relative_15 = ifelse(`YCCAL-6800`==1, 'Yes',ifelse(`YCCAL-6800`==0,'No','NaN'))) %>% dplyr::group_by(YEAR,relative_15) %>% dplyr::mutate(relative_15_proportion = n()) %>% ungroup() %>% dplyr::group_by(YEAR,relative_15, relative_15_proportion) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = relative_15_proportion)) +
geom_bar(stat="identity",aes(fill = relative_15)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_fill_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = , color = 'Response') +
labs(fill = "Relative 15 Miles Away??", y="Count", x = "")
p5
#ggplotly(p5)
NLSY_imputed_FAMILY_CARE_CAT %>% dplyr::select(PUBID_1997,YEAR,`YCCAL-6800`,CV_HH_UNDER_6,CV_BIO_CHILD_HH,INCOME,CV_ENROLLSTAT_EDT,`YCCA-450`,`YCCAL-450`,FAMILY_CARE,RELATIVE_CARE,SIBLING_CARE,`YCCAL-1100A~000002`,FAMILY_DAY_CARE,WORK_EDU_HRS) %>% subset(CV_HH_UNDER_6>0 & CV_BIO_CHILD_HH>0) %>%
subset(INCOME>0) %>%
# dplyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>%
dplyr::mutate(relative_15 = ifelse(`YCCAL-6800`==1, 'Yes',ifelse(`YCCAL-6800`==0,'No','NA'))) %>%
group_by(YEAR) %>% dplyr::mutate(year_count = n()) %>% ungroup() %>%
dplyr::group_by(YEAR,relative_15) %>% dplyr::mutate(relative_15_proportion = n()/year_count) %>%
ungroup() %>%
#subset(relative_15 == 'Yes') %>%
dplyr::group_by(YEAR, relative_15, relative_15_proportion) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = relative_15_proportion)) +
geom_point(aes(color = relative_15))+
geom_line(stat="identity",aes(color = relative_15, linetype = relative_15)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_continuous(limits=c(2005,2008,2011,2015)) +
labs(title = "NLSY Panel Proportions:\nANY RELATIVES LIVE WITHIN 15 MINUTES OF CHILD'S HOME?",
y="Proportion", x = "",linetype = "Relative-Provided Childcare",color="Relative-Provided Childcare")
# No filtering for only individuals with valid data around inter-generational childcare
NLSY_Valid <-  NLSY_imputed %>%
filter(CV_HGC_EVER_EDT != 95 & !is.na(CV_HGC_EVER_EDT)) %>%
filter(CV_HGC_EVER_EDT >= 12)
NSLY_Valid_Summarized <- NLSY_Valid %>% dplyr::mutate(ANY_CHILDREN = ifelse(N_CHILDREN == 0,0,1)) %>% group_by(YEAR,ANY_CHILDREN) %>% dplyr::summarize(mean_income = mean(INCOME,na.rm=TRUE)) %>% mutate(ANY_CHILDREN = ifelse(ANY_CHILDREN==0,'No Children', 'One or More Children'))
NSLY_Valid_Summarized$YEAR <- as.numeric(NSLY_Valid_Summarized$YEAR)
NSLY_Valid_Summarized %>% subset(YEAR>=2005) %>%
ggplot(.,aes(x=YEAR, y=mean_income/1000)) +
geom_point(color = "#273237") +
geom_line(color = "#273237",aes(linetype = ANY_CHILDREN)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)
) +
scale_x_continuous(limits=c(2005,2010,2015)) +
labs(title = "",
y="Mean Annual Income\n($ thousands)", x = "",linetype = "")
NLSY_imputed_FAMILY_CARE_CAT <- NLSY_imputed_FAMILY_CARE_CAT %>% subset(!is.na(`YCCAL-6800`))
NLSY_imputed_FAMILY_CARE_CAT <- NLSY_imputed_FAMILY_CARE_CAT %>% subset(!is.na(FAMILY_CARE))
NLSY_imputed_FAMILY_CARE_CAT %>% dplyr::select(PUBID_1997,YEAR,`YCCAL-6800`,CV_HH_UNDER_6,CV_BIO_CHILD_HH,INCOME,CV_ENROLLSTAT_EDT,`YCCA-450`,`YCCAL-450`,FAMILY_CARE) %>% subset(CV_HH_UNDER_6>0 & CV_BIO_CHILD_HH>0) %>%
#subset(`YCCAL-450`!=0) %>%
dplyr::mutate(relative_15 = ifelse(`YCCAL-6800`==1, 'Yes',ifelse(`YCCAL-6800`==0,'No','NaN'))) %>%
dplyr::mutate(FAMILY_CARE_CAT = ifelse(`FAMILY_CARE`==0, 'No',ifelse(`FAMILY_CARE`==1,'Yes','NaN'))) %>%
dplyr::group_by(relative_15,FAMILY_CARE) %>%
dplyr::mutate(FAMILY_CARE_count = n()) %>% ungroup() %>%
mutate(perc=100*FAMILY_CARE_count/nrow(NLSY_imputed_FAMILY_CARE_CAT)) %>%
dplyr::group_by(relative_15, FAMILY_CARE_CAT,FAMILY_CARE_count,perc) %>%
dplyr::summarize() %>%
ggplot(aes(x = relative_15, y = perc)) +
geom_bar(stat="identity",aes(fill = FAMILY_CARE_CAT),position = "dodge") +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_fill_manual(values=c("#ff6f00", "#008fa0")) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = , color = 'Response') +
labs(fill = "Relative Care is a primary source of childcare?", y="Percent of Data", x = "Relative is within 15 Miles?")
NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,CV_BIO_CHILD_HH,CHILDCARE_TYPE) %>% subset(YEAR>2005) %>%
subset(CV_BIO_CHILD_HH==1) %>%
dplyr::group_by(YEAR) %>% mutate(Total_Year = n()) %>% ungroup() %>%
group_by(YEAR,CHILDCARE_TYPE) %>% dplyr::mutate(CHILDCARE_TYPE_COUNT = n()/Total_Year) %>% ungroup() %>%  dplyr::group_by(YEAR,CHILDCARE_TYPE, CHILDCARE_TYPE_COUNT) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = CHILDCARE_TYPE_COUNT)) +
geom_point(stat="identity",aes(color = CHILDCARE_TYPE)) +
geom_line(stat="identity",aes(color = CHILDCARE_TYPE, linetype = CHILDCARE_TYPE)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
#scale_fill_manual(values=c("#C9473B", "#75A1AD")) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_continuous(limits=c(2010,2015)) +
labs(linetype = "Type of Childcare", color = "Type of Childcare",
y="Count", x = "", title = "Intergenerational Childcare\n (all women with ONLY one biological child**)",
caption = "During first 6 years of first child")
NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,CV_BIO_CHILD_HH,CHILDCARE_TYPE) %>% subset(YEAR>2005) %>%
dplyr::group_by(YEAR) %>% mutate(Total_Year = n()) %>% ungroup() %>%
group_by(YEAR,CHILDCARE_TYPE) %>% dplyr::mutate(CHILDCARE_TYPE_COUNT = n()/Total_Year) %>% ungroup() %>%  dplyr::group_by(YEAR,CHILDCARE_TYPE, CHILDCARE_TYPE_COUNT) %>% dplyr::summarize() %>%
ggplot(aes(x = YEAR, y = CHILDCARE_TYPE_COUNT)) +
geom_point(stat="identity",aes(color = CHILDCARE_TYPE)) +
geom_line(stat="identity",aes(color = CHILDCARE_TYPE, linetype = CHILDCARE_TYPE)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
#scale_fill_manual(values=c("#C9473B", "#75A1AD")) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_continuous(limits=c(2010,2015)) +
labs(linetype = "Type of Childcare", color = "Type of Childcare",
y="Proportion of Year*", x = "", title = "Intergenerational Childcare\n (all women with AT LEAST one biological child**)",
caption = "*Each year's aggregated group includes mothers whose first-born child is under 6 years of age.")
mean_maternal_ages <-  NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,WORK_EDU_HRS,FAMILY_CARE,MATERNAL_AGE) %>% subset(YEAR>2005) %>%
dplyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>%
dplyr::group_by(YEAR,FAMILY_CARE_CAT) %>% mutate(Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
dplyr::group_by(YEAR) %>% mutate(Overall_Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
group_by(YEAR,Mean_Maternal_Age,Overall_Mean_Maternal_Age,FAMILY_CARE_CAT) %>% dplyr::summarize()
mean_maternal_ages
mean_maternal_ages %>%
ggplot(aes(x = YEAR)) +
geom_point(stat="identity",aes(y=Mean_Maternal_Age,color = FAMILY_CARE_CAT)) +
geom_line(stat="identity",aes(y=Mean_Maternal_Age,color = FAMILY_CARE_CAT)) +
geom_point(stat="identity",aes(y=Overall_Mean_Maternal_Age), alpha = 0.5) +
geom_line(stat="identity",aes(y=Overall_Mean_Maternal_Age), linetype = 'dashed', alpha = 0.5) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_discrete(limits=c(2010,2015)) +
labs(linetype = "Relative-Provided Childcare", color = "Relative-Provided Childcare",
y="Mean Age", x = "", title = "")
ses_care_type <-  NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,MARRIED_OR_COHABITATING,INCOME,WORK_EDU_HRS,CV_INCOME_FAMILY,FAMILY_CARE,MATERNAL_AGE) %>% subset(YEAR>2005) %>%
dplyr::mutate(SES = ifelse(
#MARRIED_OR_COHABITATING == 1, ifelse(
CV_INCOME_FAMILY < 45000,'Lower-Class',
ifelse(CV_INCOME_FAMILY < 135000, 'Middle-Class','Upper-Class'))
#,ifelse(INCOME < 15000,'Lower-Class',
# ifelse(CV_INCOME_FAMILY < 75000, 'Middle-Class','Upper-Class'))))
) %>%
dplyr::mutate(FAMILY_CARE_CAT = ifelse(`WORK_EDU_HRS`==0, 'No (Mother Provides Childcare)',ifelse(`FAMILY_CARE`==1,'Yes',ifelse(FAMILY_CARE==0,'No (Other Childcare)',NaN)))) %>%
dplyr::group_by(SES) %>% mutate(SES_TOT = n()) %>% ungroup() %>%
dplyr::group_by(SES,FAMILY_CARE_CAT) %>% mutate(CARE_TOT = n()) %>% ungroup() %>%
mutate(CARE_PROP = CARE_TOT/SES_TOT) %>% ungroup() %>%
group_by(SES,FAMILY_CARE_CAT,CARE_PROP) %>% dplyr::summarize()
ses_care_type %>%
ggplot(aes(x = SES, y= CARE_PROP)) +
geom_bar(stat="identity",aes(color = FAMILY_CARE_CAT,fill = FAMILY_CARE_CAT)) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_color_futurama(alpha = 0.75) +
scale_fill_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
labs(linetype = "Socioeconomic Status", color = "Child Care Category", fill = "Child Care Category",
y="Proportion", x = "Socioeconomic Status (household income)", title = "Do richer people have more paid childcare? ")
mean_maternal_ages_ses <-  NLSY_Valid_Childcare_1 %>% dplyr::select(PUBID_1997,YEAR,MARRIED_OR_COHABITATING,INCOME,CV_INCOME_FAMILY,FAMILY_CARE,MATERNAL_AGE) %>% subset(YEAR>2005) %>%
dplyr::mutate(SES = ifelse(
#MARRIED_OR_COHABITATING == 1, ifelse(
CV_INCOME_FAMILY < 45000,'Lower-Class',
ifelse(CV_INCOME_FAMILY < 135000, 'Middle-Class','Upper-Class'))
#,ifelse(INCOME < 15000,'Lower-Class',
# ifelse(CV_INCOME_FAMILY < 75000, 'Middle-Class','Upper-Class'))))
) %>%
group_by(YEAR,SES) %>% mutate(Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
dplyr::group_by(YEAR) %>% mutate(Overall_Mean_Maternal_Age = mean(MATERNAL_AGE)) %>% ungroup() %>%
group_by(YEAR,Mean_Maternal_Age,Overall_Mean_Maternal_Age,SES) %>% dplyr::summarize()
mean_maternal_ages_ses %>%
ggplot(aes(x = YEAR)) +
geom_point(stat="identity",aes(y=Mean_Maternal_Age,color = SES)) +
geom_line(stat="identity",aes(y=Mean_Maternal_Age,color = SES)) +
geom_point(stat="identity",aes(y=Overall_Mean_Maternal_Age), alpha = 0.5) +
geom_line(stat="identity",aes(y=Overall_Mean_Maternal_Age), linetype = 'dashed', alpha = 0.5) +
theme_ipsum(base_size = 12, axis_title_size = 14) +
scale_color_futurama(alpha = 0.75) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
labs(title = '', color = 'Response') +
scale_x_continuous(limits=c(2010,2015)) +
labs(linetype = "Socioeconomic Status", color = "Socioeconomic Status",
y="Mean Age", x = "", title = "")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/data_exploration/exploratory_analysis.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/draft_models.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/draft_models.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/draft_models.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/draft_models.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/draft_models.Rmd")
source("~/QMSS/Intergenerational_Childcare_Maternal_Wage_Gap/code/results/final_results.Rmd")
